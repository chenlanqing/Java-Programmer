
## 1、什么是软件设计

关注长期变化的软件设计，软件设计，是一门关注长期变化的学问

软件最核心的三个部分：模型、接口和实现

软件设计应该包含两部分：
- 模型：是一个软件的骨架，是一个软件之所以是这个软件的核心。
  - 模型的粒度可大可小；
  - 常说的“高内聚、低耦合”指的就是对模型的要求，一个好的模型可以有效地隐藏细节，让开发者易于理解；
  - 模型是分层的，可以不断地叠加，基于一个基础的模型去构建上一层的模型，计算机世界就是这样一点点构建出来的；
- 规范：限定了什么样的需求应该以怎样的方式去完成。它对于维系软件长期演化至关重要，关于规范，常见的两种问题是：
  - 一个项目缺乏显式的、统一的规范；
  - 规范不符合软件设计原则。

模型与规范，二者相辅相成。一个项目最初建立起的模型，往往是要符合一定规范的，而规范的制定也有赖于模型

> 软件设计，应该包括模型和规范；

### 1.1、分解

软件开发就是解决问题，最常见的解决问题的思路是：分而治之；那么如何分解和组合，是软件设计需要考虑的问题

常见的分解问题就是分解的粒度太大了，把各种维度混淆在一起。在设计中，将一个模块的不同维度分开，有一个专门的说法，叫**分离关注点**；

分离关注点很重要：
- 一方面，不同的关注点混在一起会带来许多问题；
- 另一方面，分离关注点有助于我们发现不同模块的共性，更好地进行设计；

常见关注点混淆是：技术和业务的混淆；

把业务处理和技术实现混在一起，类似问题比较多。比如我们经常问怎么处理分布式事务，怎么做分库分表等。其实，你更应该问的是，我的业务需要分布式事务吗？我是不是业务划分没有做清楚，才造成了数据库的压力？

### 1.2、可测试性

要保证每个小模块的正确性，就要保证每个模块在开发阶段能够测试，而想要每个模块能够测试，在设计过程中，就要保证每个模块是可以测试的，而这就是可测试性。

如何在设计中考虑可测试性呢？其实就是要在设计时想一下，这个函数/模块/系统要怎么测，因此在设计一个函数/模块/系统时，必须将可测试性纳入考量，以便于能够完成不同层次的测试，减少对集成环境的依赖

如何做：
- 一方面，尽可能地给每个模块更多的测试，使构成系统的每个模块尽可能稳定，把集成测试环境更多地留作公共的验收资源。
- 另一方面，尽可能搭建本地的集成测试环境，周边的系统可以采用模拟服务的方案

在软件开发过程中考虑测试，实际上是思考软件的质量问题

## 2、如何了解一个软件的设计

如果接到一个新项目，阅读源码是必经的一步，却不应该是你的第一步。应该先从了解软件的设计开始

了解一个软件的设计可以从三个部分着手：模型、接口和实现
- 理解一个设计中的模型，可以帮助建立起对这个软件整体的认知；而理解一个模型的关键在于，要了解这个模型设计的来龙去脉，知道它是如何解决相应的问题。一方面，可以增进了我们对它的了解，但另一方面，也会减少我们对模型的破坏或滥用；
- 如果想深入源码，去了解一个软件，接口是一个很好的指向标。可以从一个接口进入到软件中，看它是怎样完成各种基本功能的；看接口的一个方法是找主线，看风格。
  - 先找到一条功能主线，对项目建立起结构性的了解。从文档起步，沿着主线梳理项目相关接口；
  - 有了主线之后，再沿着主线把相关接口梳理出来；维护项目的统一风格；
- 实现是指软件提供的模型和接口在内部是如何实现的，这是软件能力得以发挥的根基；如何找到实现，需要找到两个关键点：软件的结构和关键的技术：
  - 了解软件的结构，其实，就是把分层的模型展开，看下一层的模型。一方面，你要知道这个层次给你提供了怎样的模型，另一方面，你要带着自己的问题去了解这些模型为什么要这么设计；
  - 关键技术就是让这个软件与众不同的地方；

模型和接口的稳定度都要比实现高，实现则是要随着软件发展而不断调整；所以一般讨论设计的顺序：**先模型，再接口，最后是实现**

比如了解操作系统，就知道它有内存管理、进程调度、文件系统等模块。可以按照模型、接口和实现去理解每个模块，以进程管理为例：
- 进程管理的核心模型就包括进程模型和调度算法；
- 它的接口就包括，进程的创建、销毁以及调度算法的触发等；
- 不同调度算法就是一个个具体的实现；







