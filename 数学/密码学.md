## 1、消息摘要和Base64编码

### 1.1、消息摘要

消息摘要（Message Digest）又称为数字摘要(Digital Digest)，它是一个唯一对应一个消息或文本的固定长度的值，它由一个单向Hash加密函数对消息进行作用而产生。消息摘要使用数字摘要生成的值是不可以篡改的，以确保保证文件或者值的安全。无论输入的消息有多长，计算出来的消息摘要的长度总是固定的。例如应用MD5算法摘要的消息有128个比特位，用SHA-1算法摘要的消息最终有160比特位的输出；

只要输入的消息不同，对其进行摘要以后产生的摘要消息也必不相同，但相同的输入必会产生相同的输出，且消息摘要是单向、不可逆的

常见算法有:
- MD5
- SHA1
- SHA256
- SHA512

比如MD5实现参考：[MD5Utils.java](../Java/代码片段/source/DigestUtils.java)

### 1.2、Base64编码

Base64是网络上最常见的用于传输8Bit字节码的可读性编码算法之一，该算法不是为了保护数据的安全性，而是为了可读性。可读性编码不改变信息内容，只改变信息内容的表现形式，所谓 Base64，即是说在编码过程中使用了64种字符，大写A到Z、小写a到z、数字0到9、“+”和“/”。Base58是Bitcoin（比特币）中使用的一种编码方式，主要用于产生Bitcoin的钱包地址。相比Base64，Base58不使用数字"0"，字母大写"O"，字母大写"I"，和字母小写"i"，以及"+"和"/"符号；

base64原理：base64 是 3个字节为一组，一个字节 8位，一共 就是24位 ，然后，把3个字节转成4组，每组6位；$3 * 8 = 4 * 6 = 24$ ，每组6位，缺少的2位，会在高位进行补0 ，这样做的好处在于 ，base取的是后面6位，去掉高2位 ，那么base64的取值就可以控制在0-63位了，所以就叫base64，$111 111 = 32 + 16 + 8 + 4 + 2 + 1$ 

base64有个 `=` 号，但是在映射表里面没有发现 `=` 号 ， 这个地方需要注意，等号非常特殊，因为base64是三个字节一组 ，如果当我们的位数不够的时候，会使用等号来补齐：

## 2、对称加密

### 2.1、加密算法

采用单钥密码系统的加密方法，同一个密钥可以同时用作信息的加密和解密，这种加密方法称为对称加密，常见的对称加密算法主要有 `DES`、`3DES`、`AES`
- DES : Data Encryption Standard，即数据加密标准，是一种使用密钥加密的块算法，1977年被美国联邦政府的国家标准局确定为联邦资料处理标准（FIPS），并授权在非密级政府通信中使用，随后该算法在国际上广泛流传开来。
- AES : Advanced Encryption Standard, 高级加密标准 .在密码学中又称Rijndael加密法，是美国联邦政府采用的一种区块加密标准。这个标准用来替代原先的DES，已经被多方分析且广为全世界所使用。

主要特点：
- 加密速度快, 可以加密大文件
- 密文可逆, 一旦密钥文件泄漏, 就会导致数据暴露
- 加密后编码表找不到对应字符, 出现乱码
- 一般结合Base64使用

JDK 中的 Cipher 中有使用AES和DES的方法，在线文档地址如下： [Cipher.java](https://docs.oracle.com/javase/8/docs/api/javax/crypto/Cipher.html)

### 2.2、加密模式和填充模式

**加密模式**：有ECB和CBC两种
- ECB : Electronic codebook, 电子密码本. 需要加密的消息按照块密码的块大小被分为数个块，并对每个块进行独立加密：
    - 优点 : 可以并行处理数据
    - 缺点 : 同样的原文生成同样的密文, 不能很好的保护数据
    - 同时加密，原文是一样的，加密出来的密文也是一样的
- CBC : Cipher-block chaining, 密码块链接. 每个明文块先与前一个密文块进行异或后，再进行加密。在这种方法中，每个密文块都依赖于它前面的所有明文块：
    - 优点 : 同样的原文生成的密文不一样
    - 缺点 : 串行处理数据.

**填充模式**：当需要按块处理的数据, 数据长度不符合块处理需求时，按照一定的方法填充满块长的规则。    
- *NoPadding：*不填充.
    - 在DES加密算法下, 要求原文长度必须是8byte的整数倍
    - 在AES加密算法下, 要求原文长度必须是16byte的整数倍
- *PKCS5Padding：*数据块的大小为8位, 不够就补足

默认情况下, 加密模式和填充模式为 : `ECB/PKCS5Padding`。如果使用CBC模式, 在初始化Cipher对象时, 需要增加参数, 初始化向量IV :
```java
IvParameterSpec iv = new IvParameterSpec(key.getBytes());
```
加密模式和填充模式有：
```
AES/CBC/NoPadding (128)
AES/CBC/PKCS5Padding (128)
AES/ECB/NoPadding (128)
AES/ECB/PKCS5Padding (128)
DES/CBC/NoPadding (56)
DES/CBC/PKCS5Padding (56)
DES/ECB/NoPadding (56)
DES/ECB/PKCS5Padding (56)
DESede/CBC/NoPadding (168)
DESede/CBC/PKCS5Padding (168)
DESede/ECB/NoPadding (168)
DESede/ECB/PKCS5Padding (168)
RSA/ECB/PKCS1Padding (1024, 2048)
RSA/ECB/OAEPWithSHA-1AndMGF1Padding (1024, 2048)
RSA/ECB/OAEPWithSHA-256AndMGF1Padding (1024, 2048)
```
默认情况下，如果没有写填充模式和加密模式，那么默认就使用`DES/ECB/PKCS5Padding`

## 3、非对称加密

- [Public-key cryptography](https://en.wikipedia.org/wiki/Public-key_cryptography)
- [加密与解密算法](https://juejin.cn/post/6844903638117122056)

### 3.1、基础概念

非对称加密是计算机通信安全的基石，保证了加密数据不会被破解。与对称加密算法不同，非对称加密算法需要两个密钥公开密钥(publickey)和私有密(privatekey)，公开密钥和私有密钥是一对：
- 如果用公开密钥对数据进行加密，只有用对应的私有密钥才能解密
- 如果用私有密钥对数据进行加密，只有用对应的公开密钥才能解密

因为加密和解密使用的是两个不同的密钥，所以这种算法叫作非对称加密算法

- 加密：公钥加密，私钥解密的过程，称为「加密」<br/>
    因为公钥是公开的，任何公钥持有者都可以将想要发送给私钥持有者的信息进行加密后发送，而这个信息只有私钥持有者才能解密。
- 签名：私钥加密，公钥解密的过程，称为「签名」<br/>
    它和加密有什么区别呢？因为公钥是公开的，所以任何持有公钥的人都能解密私钥加密过的密文，所以这个过程并不能保证消息的安全性，但是它却能保证消息来源的准确性和不可否认性，也就是说，如果使用公钥能正常解密某一个密文，那么就能证明这段密文一定是由私钥持有者发布的，而不是其他第三方发布的，并且私钥持有者不能否认他曾经发布过该消息。故此将该过程称为「签名」

常见的 **非对称算法** 主要有 `RSA`、`DSA` 等

### 3.2、RSA加密算法

- [Wikipedia-RSA (cryptosystem)](https://en.wikipedia.org/wiki/RSA_(cryptosystem))
- [Hutool-非对称加密算法](https://doc.hutool.cn/pages/AsymmetricCrypto/#ecies)

RSA是1977年由罗纳德·李维斯特（Ron Rivest）、阿迪·萨莫尔（Adi Shamir）和伦纳德·阿德曼（Leonard Adleman）一起提出的。当时他们三人都在麻省理工学院工作。RSA就是他们三人姓氏开头字母拼在一起组成的。1973年，在英国政府通讯总部工作的数学家克利福德·柯克斯（Clifford Cocks）在一个内部文件中提出了一个相同的算法，但他的发现被列入机密，一直到1997年才被发表。

对极大整数做因数分解的难度决定了RSA算法的可靠性。 换言之，对一极大整数做因数分解愈困难，RSA算法愈可靠。假如有人找到一种快速因数分解的算法的话，那么用RSA加密的信息的可靠性就肯定会极度下降。 但找到这样的算法的可能性是非常小的。今天只有短的RSA钥匙才可能被强力方式解破。到目前为止，世界上还没有任何可靠的攻击RSA算法的方式。只要其钥匙的长度足够长，用RSA加密的信息实际上是不能被解破的。

具体实现参考：[RSAUtils.java](../Java/代码片段/source/RSAUtils.java)

## 4、数字签名

## 5、bcrypt加密

- [bcrypt](https://en.wikipedia.org/wiki/Bcrypt)
- [Spring Security-BCryptPasswordEncoder]()

bcrypt，是一个跨平台的文件加密工具。由它加密的文件可在所有支持的操作系统和处理器上进行转移。它的口令必须是8至56个字符，并将在内部被转化为448位的密钥。bcrypt 使用的是布鲁斯·施内尔在1993年发布的 Blowfish 加密算法。具体来说，bcrypt 使用保罗·柯切尔的算法实现

Java中使用bcrypt，可以使用 spring security：
```java
@Bean
public PasswordEncoder passwordEncoder() {
    return new BCryptPasswordEncoder();
}
```

## 6、国密

- [国密算法标准文档](https://github.com/chenlanqing/GM-Standards)
- [支持国密SM2/SM3/SM4/SM9/ZUC/SSL的密码工具箱](http://gmssl.org/)
- [支持国密的密码工具箱](https://github.com/guanzhi/GmSSL)
- [Hutool-国密加密实现](https://doc.hutool.cn/pages/SmUtil/#%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86sm4)

国密算法是国家商用密码算法的简称，由国家密码管理局管理和发布标准



## 参考资料

- [写给开发人员的密码学](https://thiscute.world/posts/practical-cryptography-basics-1/)
- [密码学简介](https://ctf-wiki.org/crypto/introduction/)
- [RSA加密算法原理](https://www.ruanyifeng.com/blog/2013/07/rsa_algorithm_part_two.html)
- [深入浅出密码学](https://paper.bobylive.com/Science/%E3%80%8A%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA%E5%AF%86%E7%A0%81%E5%AD%A6%E2%80%94%E2%80%94%E5%B8%B8%E7%94%A8%E5%8A%A0%E5%AF%86%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%E3%80%8B.pdf)
- 国密算法
