# 1、结构体

## 1.1、基本概念

结构体是用户自定义的类型，可以将多种数据的表示合并到一起，描述一个完整的对象。

使用结构体有两个步骤：1）定义结构体描述（类型）；2）创建结构体变量

## 1.2、定义

定义结构体描述的语法：
```cpp
struct 结构体名
{
    成员一的数据类型  成员名一;
    成员二的数据类型  成员名二;
    成员三的数据类型  成员名三;
    ......
    成员n的数据类型  成员名n;
};
```
注意：
- 结构体名是标识符。
- 结构体的成员可以是任意数据类型。
- 定义结构体描述的代码可以放在程序的任何地方，一般放在main函数的上面或头文件中。
- 结构体成员可以用C++的类（如string），但是不提倡。
- 在C++中，结构体中可以有函数，但是不提倡。
- 在C++11中，定义结构体的时候可以指定缺省值。

```cpp
struct student {
    char name[20];
    int age;
    float score;
};
```

## 1.3、创建结构体变量

创建结构体变量的语法：`struct 结构体名 结构体变量名;`

也可以为结构体成员赋初始值。`struct 结构体名 结构体变量名={成员一的值, 成员二的值,......, 成员n的值};`

- C++11可以不写等于号。
- 如果大括号内未包含任何东西或只写一个0，全部的成员都将被设置为0：`struct 结构体名 结构体变量名={0};`

注意：
- 在C++中，struct关键字可以不写。
- 可以在定义结构体的时候创建结构体变量。

```cpp
// 可以不写struct关键字
student s1;
```
定义结构体的时候创建结构体变量：
```cpp
struct student {
  char name[20];
  int age;
  float score;
} stu;
int main() {
  student s1 = {"张三", 18, 100};
  cout << s1.name << endl;
  stu = {"张三", 18, 100};
}
```

## 1.4、使用

在C++程序中，用成员运算符（.）来访问结构体的每个成员。结构体中的每个成员具备普通变量的全部特征。

语法：`结构体变量名.结构体成员名;`
```cpp
int main() {
  student s1 = {"张三", 18, 100};
  cout << s1.name << endl;
  stu = {"张三", 18, 100};
}
```

## 1.5、内存占用

用`sizeof`运算符可以得到整个结构体占用内存的大小。

注意：整个结构体占用内存的大小不一定等于全部成员占用内存之和。因为存在内存对齐

内存对齐：`#pragma pack(字节数)`

合理使用内存对齐规则，某些节省内存的做法可能毫无意义


## 1.6、结构体赋值

**清空结构体**

创建的结构体变量如果没有初始化，成员中有垃圾值。

用memset()函数可以把结构体中全部的成员清零。（只适用于C++基本数据类型）

bzero()函数也可以。

**结构体复制**

用memcpy()函数把结构体中全部的元素复制到另一个相同类型的结构体（只适用于C++基本数据类型）。

也可以直接用等于号（只适用于C++基本数据类型）。

# 2、结构体指针

在C++中，用不同类型的指针存放不同类型变量的地址，这一规则也适用于结构体。如下：
```cpp
struct student stu;         // 声明结构体变量stu。
struct student *pst=&stu;  // 声明结构体指针，指向结构体变量stu。
```
通过结构体指针访问结构体成员，有两种方法：
```cpp
(*指针名).成员变量名    // (*pst).name和(*pst).age 
```
或者：
```cpp
指针名->成员变量名    // pst->name和*pst->age 
```
在第一种方法中，圆点`.`的优先级高于`*`，`(*指针名)`两边的括号不能少。如果去掉括号写成`(*指针名).成员变量名`，那么相当于`*(指针名.成员变量名)`，意义就完全不一样了。

在第二种方法中，`->`是一个新的运算符。

上面的两种方法是等效的，通常采用第二种方法，更直观

主要用途：
（1）用于函数的参数，如果要把结构体传递给函数，实参取结构体变量的地址，函数的形参用结构体指针，如果不希望在函数中修改结构体变量的值，可以对形参加const约束；
```cpp
void func(const student* stu)
{
    stu -> age = 100; //报错：cannot assign to variable 'stu' with const-qualified type 'const student
}
```

（2）用于动态分配内存


